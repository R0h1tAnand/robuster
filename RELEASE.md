# Release Process

This repository uses **fully automated** GitHub Actions to build and release binaries for Linux and Windows.

## ðŸš€ Automated Release (Recommended)

The easiest way! Just update the version and push:

1. **Update the version in `Cargo.toml`**
   ```toml
   [package]
   version = "1.0.1"  # Update this to your new version
   ```

2. **Commit and push your changes**
   ```bash
   git add .
   git commit -m "feat: your feature description"
   git push origin main
   ```

3. **That's it! ðŸŽ‰**
   - The workflow automatically detects the new version from `Cargo.toml`
   - Checks if this version already exists (skips if yes)
   - Runs tests, formatting, and clippy checks
   - Builds binaries for Linux and Windows
   - Creates a git tag automatically
   - Creates a GitHub release with binaries
   - Publishes to crates.io

4. **Wait for the workflow to complete**
   - The GitHub Actions workflow will automatically:
     - Build binaries for Linux (x86_64-unknown-linux-gnu)
     - Build binaries for Windows (x86_64-pc-windows-msvc)
     - Create a GitHub release
     - Upload both binaries to the release
     - Generate release notes

5. **Check the release**
   - Visit: https://github.com/R0h1tAnand/robuster/releases
   - Or check workflow status: https://github.com/R0h1tAnand/robuster/actions

5. **Check the release**
   - The release will include:
     - `robuster-linux-x86_64` (Linux binary)
     - `robuster-windows-x86_64.exe` (Windows binary)
     - Source code archives (automatically generated by GitHub)
   - Automatically published to crates.io

## ðŸ”§ Manual Release (Advanced)

If you prefer manual control, you can still use the traditional method:

1. **Update version in `Cargo.toml`**

2. **Create and push a git tag manually**
   ```bash
   git tag v1.0.1
   git push origin v1.0.1
   ```

3. This triggers the manual release workflow

## Tag Naming Convention

- Versions follow semantic versioning: `{major}.{minor}.{patch}`
- Tags are automatically created as: `v{major}.{minor}.{patch}`
- Examples: `v1.0.0`, `v1.2.3`, `v2.0.0`

## Workflows

### Auto-Release Workflow (`.github/workflows/auto-release.yml`)
- **Trigger**: Push to `main` branch when `Cargo.toml` or source files change
- **What it does**:
  1. Extracts version from `Cargo.toml`
  2. Checks if version tag already exists (skips if duplicate)
  3. Runs full test suite (tests, fmt, clippy)
  4. Builds Linux and Windows binaries
  5. Creates git tag automatically
  6. Creates GitHub release with binaries
  7. Publishes to crates.io

### Manual Release Workflow (`.github/workflows/release.yml`)
- **Trigger**: Push a tag matching `v*.*.*`

### Build Matrix

The workflow builds on multiple platforms in parallel:
- **Linux**: `ubuntu-latest` with target `x86_64-unknown-linux-gnu`
- **Windows**: `windows-latest` with target `x86_64-pc-windows-msvc`

### Caching

The workflow uses GitHub Actions cache for:
- Cargo registry
- Cargo index
- Target directory

This significantly speeds up subsequent builds.

## Manual Release (Alternative)

If you prefer to create a release manually without the workflow:

```bash
# Build for Linux (current platform)
cargo build --release

# Build for Windows (requires cross-compilation setup)
cargo build --release --target x86_64-pc-windows-gnu

# Create release using GitHub CLI
gh release create v1.0.1 \
  --title "robuster v1.0.1" \
  --notes "Release notes here" \
  target/release/robuster \
  target/x86_64-pc-windows-gnu/release/robuster.exe
```

## Troubleshooting

### Workflow fails to build

1. Check the Actions tab in your repository
2. Look at the build logs for specific errors
3. Ensure all dependencies are properly specified in `Cargo.toml`

### Release not created

1. Verify the tag matches the pattern `v*.*.*`
2. Check that the `GITHUB_TOKEN` has sufficient permissions
3. Review the workflow logs in the Actions tab

### Binary not uploaded

1. Ensure the artifact paths in the workflow are correct
2. Verify the build completed successfully
3. Check the `files:` section in the `create-release` job
